// Language translations for Timepot landing page
const translations = {
    en: {
        // Navigation
        'nav.features': 'Features',
        'nav.how-it-works': 'How It Works',
        'nav.home': 'Home',
        'nav.pricing': 'Pricing',
        
        // Hero Section
        'hero.title': 'Turn Screen Time into Quality Time',
        'hero.subtitle': 'Timepot helps your family build healthier digital habits together. No more fighting, just collaborating.',
        'hero.cta': 'Watch How It Works',
        
        // Video Section
        'video.title': 'See How Timepot Works',
        'video.id': 'wZDorOa3pTA',
        'video.question': 'Curious to see your saving potential?',
        'video.cta.yes': 'Yes, Let’s Find Out',
        'video.cta.maybe': 'Maybe, Tell Me More',
        
        // Sharing Section
        'sharing.title': 'Sharing is Caring',
        'sharing.subtitle': 'For Timepot to work, you’ll need to share some limited screen time data with your family. By sharing your daily screen time with us, you’ll unlock insights and see how much time you can save starting today.',
        
        // Demo Section
        'demo.title': 'See Your Personalized Savings Potential',
        'demo.subtitle': 'Enter your daily average screen time to see how much quality time you could reclaim.',
        'demo.tip': 'Tip: Open Screen Time on iPhone or Digital Wellbeing on Android',
        'demo.your-time': 'Your Daily Screen Time',
        'demo.hours': 'hours',
        'demo.cta': 'Calculate My Savings',
        'demo.potential-title': 'Your Saving Potential',
        'demo.potential-time': '? hours',
        'demo.weekly-reduction': 'Weekly Time Saved',
        'demo.monthly-reduction': 'Monthly Time Saved',
        'demo.benefits-title': 'Imagine What You Could Do!',
        'demo.game-nights': 'game nights per month',
        'demo.books': 'books read together',
        'demo.activities': 'outdoor adventures',
        'demo.reduce.screen-time': 'By reducing just 20% of screen time, your family could gain this quality time together!',
        'demo.next-cta': 'Explore All Features',
        
        // Features Preview (index.html)
        'features-preview.title': 'Why Families Choose Timepot',
        'features-preview.challenges': 'Family Challenges',
        'features-preview.challenges-desc': 'Turn reduction into friendly competition',
        'features-preview.privacy': 'Privacy First',
        'features-preview.privacy-desc': 'Category-based, not app-specific tracking',
        'features-preview.heroes': 'Heroes & Villains',
        'features-preview.heroes-desc': 'You choose which apps to protect or limit',
        'features-preview.cta': 'View All Features',
        
        // Features Page
        'features-page.title': 'Click on a Feature to learn more!',
        
        // Feature Cards
        'feature.heroes-villains.title': 'Heroes & Villains System',
        'feature.heroes-villains.modal.title': 'Heroes & Villains System',
        'feature.heroes-villains.modal.description': 'Choose "Hero" apps that don\'t count against your time, and "Villain" apps that get punished when time runs out. You\'re in control!',
        'feature.heroes-villains.modal.audio': 'assets/heroes.mp3',


        'feature.agreements.title': 'Agreements',
        'feature.agreements.modal.title': 'Family Agreements',
        'feature.agreements.modal.description': 'Families can define agreements, real-life treats or activities, that are unlocked when specific screen time goals are met.',
        'feature.agreements.modal.audio': 'assets/agreements.mp3',

        'feature.privacy.title': 'Privacy',
        'feature.privacy.subtitle': 'App Categories',
        'feature.privacy.modal.title': 'Privacy-First App Categories',
        'feature.privacy.modal.description': 'Your privacy matters. Instead of showing specific app names, Timepot groups apps into three transparent categories: Productive, Educational, and Leisure. This allows your family members to discuss screen time habits at a category level, without exposing personal app usage details.',
        'feature.privacy.modal.audio': 'assets/categories.mp3',

        'feature.individual.title': 'Reporting',
        'feature.individual.subtitle': 'Individual Battle',
        'feature.individual.modal.title': 'Individual Battle Reporting',
        'feature.individual.modal.description': 'Track your personal screen time trends, celebrate your wins, and see your achievements over time. Focus on your own progress without comparison pressure.',
        'feature.individual.modal.audio': 'assets/individual.mp3',

        'feature.team.title': 'Reporting',
        'feature.team.subtitle': 'Team Battle',
        'feature.team.modal.title': 'Team Battle Reporting',
        'feature.team.modal.description': 'Turn screen time reduction into a friendly family challenge. See your family\'s collective progress, visualize overall achievements, and celebrate together as a team.',
        'feature.team.modal.audio': 'assets/team.mp3',

        'feature.family-vs-family.title': 'Reporting',
        'feature.family-vs-family.subtitle': 'Family vs. Family',
        'feature.family-vs-family.modal.title': 'Family vs. Family Reporting',
        'feature.family-vs-family.modal.description': 'A social comparison feature that allows families to see how their overall screen time habits compare to other similar families using Timepot.',
        'feature.family-vs-family.modal.audio': 'assets/family.mp3',

        'feature.modal.cta': 'Join the Waitlist',
        
        // Feature Modal Content (for features.html JavaScript)
        'feature.modal.audio-text': 'Let Anton explain it. Hit the play button!',
        
        // Onboarding Questions (for features.html)
        'onboarding.title': 'Let\'s personalize your Timepot experience',
        'onboarding.subtitle': 'Help us understand your family better so we can show you the most relevant features',
        'onboarding.family-size.question': 'How big is your Family (living in the same household)?',
        'onboarding.family-size.2-3': '2-3 people',
        'onboarding.family-size.4-5': '4-5 people',
        'onboarding.family-size.6-plus': '6+ people',
        'onboarding.device-age.question': 'When did your kids get their first smartphone/tablet?',
        'onboarding.device-age.1-2-years': '1-2 years ago',
        'onboarding.device-age.3-5-years': '3-5 years ago',
        'onboarding.device-age.6-10-years': '6-10 years ago',
        'onboarding.device-age.more-than-10': 'More than 10 years ago',
        'onboarding.device-age.none': 'They don\'t have smartphones yet',
        'onboarding.cta': 'Show Me Features',
        'onboarding.skip': 'Skip for now',
        'onboarding.no-kids': 'No Kids',
        
        // Pricing Section
        'pricing.title': 'What Would You Pay?',
        'pricing.subtitle': 'Help us understand what Timepot is worth to your family. Be honest - there\'s no wrong answer!',
        'pricing.label': 'Monthly price for the whole family',
        'pricing.placeholder': '0.00',
        'pricing.month': '/ month',
        'pricing.cta': 'Continue',
        'pricing.direct-waitlist': 'Skip to Waitlist',
        
        // Price Confirmation Modal
        'price-confirm.title': 'Great Choice!',
        'price-confirm.message': 'You said you\'d pay',
        'price-confirm.month': 'per month',
        'price-confirm.reserve': 'Reserve this price and we\'ll keep you updated as we get closer to launch. No payment or credit card information needed! ',
        'price-confirm.cta': 'Reserve for This Price',
        
        // Waitlist Page
        'waitlist.title': 'Awesome that you’re interested in Timepot!',
        'waitlist.message': 'We’re not quite ready to launch yet and while we can’t promise a price today, we can promise to put a lot of love into building your family’s screen-time tool.',
        'waitlist.email-placeholder': 'Enter your email address',
        'waitlist.cta': 'Join Waitlist',
        'waitlist.success': 'Thanks! We\'ll be in touch soon.',
        'waitlist.error': 'Please enter a valid email address.',
        'waitlist.survey.prompt': 'Would you be open to a quick follow-up survey so we can build Timepot with your feedback?',
        'waitlist.survey.yes': 'Sure, show me the survey',
        'waitlist.survey.no': 'Maybe later',
        'waitlist.thankyou.heading': 'You\'re on the list!',
        'waitlist.thankyou.copy': 'Thank you for joining the Timepot waitlist. We\'ll keep you in the loop as we prepare the launch.',
        
        // Footer
        'footer.copyright': 'Timepot. All rights reserved.',
        'footer.home': 'How it works',
        'footer.features': 'Features',
        'footer.pricing': 'Pricing',
    'footer.privacy': 'Privacy Disclaimer',
        
        // Common
        'common.close': 'Close',
    },
    
    de: {
        // Navigation
        'nav.features': 'Funktionen',
        'nav.how-it-works': 'Wie es funktioniert',
        'nav.home': 'Start',
        'nav.pricing': 'Preise',
        
        // Hero Section
        'hero.title': 'Familien-Zeit statt Bildschirm-Streit',
        'hero.subtitle': 'Timepot hilft deiner Familie, gemeinsam gesündere digitale Gewohnheiten aufzubauen. Kein Streit mehr, nur Zusammenarbeit.',
        'hero.cta': 'Schau dir an, wie es funktioniert',
        
        // Video Section
        'video.title': 'So funktioniert Timepot',
        'video.id': 'Fcqk6IKAxR8',
        'video.question': 'Neugierig auf dein Sparpotenzial?',
        'video.cta.yes': 'Ja, lass es uns herausfinden',
        'video.cta.maybe': 'Vielleicht, erzähl mir mehr',

        // Sharing Section
        'sharing.title': 'Sharing is Caring',
        'sharing.subtitle': 'Damit Timepot funktioniert, musst du einige begrenzte Bildschirmzeitdaten mit deiner Familie teilen. Wenn du deine tägliche Bildschirmzeit mit uns teilst, erhältst du weitere wertvolle Einblicke und siehst, wie viel Zeit du ab heute sparen könntest.',



        // Demo Section
        'demo.title': 'Dein persönliches Einsparpotenzial',
        'demo.subtitle': 'Gib deine durchschnittliche tägliche Bildschirmzeit ein, um zu sehen, wie viel Qualitätszeit du zurückgewinnen könntest.',
        'demo.tip': 'Tipp: Öffne Bildschirmzeit auf dem iPhone oder Digital Wellbeing auf Android',
        'demo.your-time': 'Deine tägliche Bildschirmzeit',
        'demo.hours': 'Stunden',
        'demo.cta': 'Berechne mein Einsparpotenzial',
        'demo.potential-title': 'Dein Sparpotenzial',
        'demo.potential-time': '? Stunden',
        'demo.weekly-reduction': 'Wöchentlich eingesparte Zeit',
        'demo.monthly-reduction': 'Monatlich eingesparte Zeit',
        'demo.benefits-title': 'Stell dir vor, was ihr tun könntet!',
        'demo.game-nights': 'Spieleabende pro Monat',
        'demo.books': 'gemeinsam gelesene Bücher',
        'demo.activities': 'Outdoor-Abenteuer',
        'demo.reduce.screen-time': 'Durch eine Reduzierung der Bildschirmzeit um nur 20 % könnte deine Familie diese wertvollen gemeinsame Momente gewinnen!',
        'demo.next-cta': 'Alle Funktionen entdecken',
        
        // Features Preview (index.html)
        'features-preview.title': 'Warum Familien Timepot wählen',
        'features-preview.challenges': 'Familien-Challenges',
        'features-preview.challenges-desc': 'Verwandle Reduzierung in freundlichen Wettbewerb',
        'features-preview.privacy': 'Privatsphäre geschützt',
        'features-preview.privacy-desc': 'Kategoriebasiert, nicht App-spezifisch',
        'features-preview.heroes': 'Helden & Schurken',
        'features-preview.heroes-desc': 'Du entscheidest, welche Apps geschützt oder begrenzt werden',
        'features-preview.cta': 'Alle Funktionen ansehen',
        
        // Features Page
        'features-page.title': 'Klicke auf eine Funktion, um mehr zu erfahren!',
        
        // Feature Cards
        'feature.heroes-villains.title': 'Helden & Schurken System',
        'feature.heroes-villains.modal.title': 'Helden & Schurken System',
        'feature.heroes-villains.modal.description': 'Wähle „Helden“-Apps, die nicht gegen deine Zeit zählen, und „Schurken“-Apps, die bestraft werden, wenn die Zeit abläuft. Du hast die volle Kontrolle!',
        'feature.heroes-villains.modal.audio': 'assets/heroes-de.mp3',

        'feature.agreements.title': 'Vereinbarungen',
        'feature.agreements.modal.title': 'Familien-Vereinbarungen',
        'feature.agreements.modal.description': 'Familien können gemeinsame Vereinbarungen festlegen, echte Belohnungen oder Aktivitäten, die freigeschaltet werden, sobald bestimmte Bildschirmzeit-Ziele erreicht sind.',
        'feature.agreements.modal.audio': 'assets/agreements-de.mp3',

        'feature.privacy.title': 'Privatsphäre',
        'feature.privacy.subtitle': 'App-Kategorien',
        'feature.privacy.modal.title': 'Volle Privatsphäre dank App-Kategorien',
        'feature.privacy.modal.description': 'Deine Privatsphäre ist uns sehr wichtig. Anstatt einzelne App-Namen zu zeigen, fasst Timepot Apps in drei transparente Kategorien zusammen: Produktiv, Lehrreich und Freizeit. So kann deine Familie über Bildschirmgewohnheiten sprechen, ohne persönliche Nutzungsdetails offenzulegen.',
        'feature.privacy.modal.audio': 'assets/categories-de.mp3',

        'feature.individual.title': 'Berichte',
        'feature.individual.subtitle': 'Individueller Kampf',
        'feature.individual.modal.title': 'Individuelle Kampf-Berichte',
        'feature.individual.modal.description': 'Verfolge deine persönlichen Bildschirmzeit-Trends, feiere deine Erfolge und sieh deine Fortschritte im Laufe der Zeit.',
        'feature.individual.modal.audio': 'assets/individual-de.mp3',

        'feature.team.title': 'Berichte',
        'feature.team.subtitle': 'Team Kampf',
        'feature.team.modal.title': 'Team Kampf-Berichte',
        'feature.team.modal.description': 'Mach aus der Reduzierung der Bildschirmzeit eine freundliche Familien-Challenge. Sieh den gemeinsamen Fortschritt und wie ihr in eurer Familie abschneidet, visualisiere eure Erfolge und feiert zusammen als Team.',
        'feature.team.modal.audio': 'assets/team-de.mp3',

        'feature.family-vs-family.title': 'Berichte',
        'feature.family-vs-family.subtitle': 'Familie gegen Familie',
        'feature.family-vs-family.modal.title': 'Familie gegen Familie Berichte',
        'feature.family-vs-family.modal.description': 'Eine soziale Vergleichsfunktion, mit der Familien sehen können, wie ihre Bildschirmzeit-Gewohnheiten im Vergleich zu anderen Familien aussehen, die ebenfalls Timepot nutzen.',
        'feature.family-vs-family.modal.audio': 'assets/family-de.mp3',

        'feature.modal.audio-text': 'Lass es Heidi erklären. Drück den Play-Button!',

        'feature.modal.cta': 'Zur Warteliste',
        
        // Onboarding Questions (for features.html)
        'onboarding.title': 'Lass uns deine Timepot-Erfahrung personalisieren',
        'onboarding.subtitle': 'Hilf uns, deine Familie besser zu verstehen, damit wir dir die relevantesten Funktionen zeigen können',
        'onboarding.family-size.question': 'Wie gross ist deine Famile (im gleichen Haushalt lebend)?',
        'onboarding.family-size.2-3': '2-3 Personen',
        'onboarding.family-size.4-5': '4-5 Personen',
        'onboarding.family-size.6-plus': '6+ Personen',
        'onboarding.device-age.question': 'Wann haben deine Kinder ihr erstes Smartphone / Tablet bekommen?',
        'onboarding.device-age.1-2-years': 'Vor 1-2 Jahren',
        'onboarding.device-age.3-5-years': 'Vor 3-5 Jahren',
        'onboarding.device-age.6-10-years': 'Vor 6-10 Jahren',
        'onboarding.device-age.more-than-10': 'Vor mehr als 10 Jahren',
        'onboarding.device-age.none': 'Sie haben noch keine Smartphones',
        'onboarding.cta': 'Zeig mir die Funktionen',
        'onboarding.skip': 'Für jetzt überspringen',
        'onboarding.no-kids': 'Keine Kinder',
        
        // Pricing Section
        'pricing.title': 'Was würdest du bezahlen?',
        'pricing.subtitle': 'Hilf uns zu verstehen, was Timepot deiner Familie wert ist. Sei ehrlich - es gibt keine falsche Antwort!',
        'pricing.label': 'Monatlicher Preis für die ganze Familie',
        'pricing.placeholder': '0.00',
        'pricing.month': '/ Monat',
        'pricing.cta': 'Weiter',
        'pricing.direct-waitlist': 'Direkt zur Warteliste',
        
        // Price Confirmation Modal
        'price-confirm.title': 'Vielen Dank!',
        'price-confirm.message': 'Du hast gesagt, du würdest bezahlen',
        'price-confirm.month': 'pro Monat',
        'price-confirm.reserve': 'Reserviere diesen Preis und wir halten dich auf dem Laufenden, wenn wir starten. Keine Zahlung oder Kreditkarteninformationen erforderlich!',
        'price-confirm.cta': 'Für diesen Preis reservieren',
        
        // Waitlist Page
        'waitlist.title': 'Wie schön, dass du dich für Timepot interessierst!',
        'waitlist.message': 'Wir sind noch nicht ganz so weit und auch wenn wir heute noch keinen Preis versprechen können, versprechen wir eines: ganz viel Liebe beim Bauen eures Familien-Bildschirmzeit-Tools.',
        'waitlist.email-placeholder': 'Gib deine E-Mail-Adresse ein',
        'waitlist.cta': 'Zur Warteliste',
        'waitlist.success': 'Danke! Wir melden uns bald bei dir.',
        'waitlist.error': 'Bitte gib eine gültige E-Mail-Adresse ein.',
        'waitlist.survey.prompt': 'Hättest du kurz Zeit für eine schnelle Umfrage, damit wir Timepot mit deinem Feedback bauen können?',
        'waitlist.survey.yes': 'Ja, zeig mir die Umfrage',
        'waitlist.survey.no': 'Vielleicht später',
        'waitlist.thankyou.heading': 'Du bist dabei!',
        'waitlist.thankyou.copy': 'Danke, dass du dich für die Timepot-Warteliste eingetragen hast. Wir halten dich auf dem Laufenden, während wir den Launch vorbereiten.',
        
        // Footer
        'footer.copyright': 'Timepot. Alle Rechte vorbehalten.',
        'footer.home': 'Wie es funktioniert',
        'footer.features': 'Funktionen',
        'footer.pricing': 'Preise',
    'footer.privacy': 'Datenschutzerklärung',
        
        // Common
        'common.close': 'Schließen',
    }
};

// Language switcher utility
class LanguageSwitcher {
    constructor() {
        this.currentLanguage = this.detectLanguage();
        this.init();
    }
    
    detectLanguage() {
        // Check localStorage first
        const saved = localStorage.getItem('timepot-language');
        if (saved && translations[saved]) {
            return saved;
        }
        
        // Check browser language
        const browserLang = navigator.language.split('-')[0];
        if (translations[browserLang]) {
            return browserLang;
        }
        
        // Default to English
        return 'en';
    }
    
    init() {
        this.applyTranslations();
        this.createLanguageToggle();
    }
    
    translate(key) {
        return translations[this.currentLanguage][key] || key;
    }
    
    applyTranslations() {
        // Find all elements with data-i18n attribute
        document.querySelectorAll('[data-i18n]').forEach(element => {
            const key = element.getAttribute('data-i18n');
            const translation = this.translate(key);
            
            // Check if we should translate placeholder
            if (element.hasAttribute('data-i18n-placeholder')) {
                element.placeholder = translation;
            } else {
                element.textContent = translation;
            }
        });
        
        // Update HTML lang attribute
        document.documentElement.lang = this.currentLanguage;
        this.applyLocalizedVideo();

    }
    
    switchLanguage(lang) {
        if (!translations[lang]) return;
        
        this.currentLanguage = lang;
        localStorage.setItem('timepot-language', lang);
        this.applyTranslations();
        this.applyLocalizedVideo();
        this.updateToggleButton();
    }
    
    createLanguageToggle() {
        // Add language dropdown to navigation
        const nav = document.querySelector('.nav-links');
        if (!nav) return;
        
        const dropdownContainer = document.createElement('li');
        dropdownContainer.className = 'language-dropdown';
        
        // Get language display names
        const languages = {
            en: 'English',
            de: 'Deutsch'
        };
        
        dropdownContainer.innerHTML = `
            <button class="lang-dropdown-btn" id="lang-dropdown-toggle" aria-label="Select language" aria-expanded="false">
                <span class="lang-current">${languages[this.currentLanguage]}</span>
                <svg class="lang-dropdown-arrow" width="12" height="8" viewBox="0 0 12 8" fill="none">
                    <path d="M1 1L6 6L11 1" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
            </button>
            <ul class="lang-dropdown-menu" id="lang-dropdown-menu" role="menu">
                <li role="menuitem">
                    <button class="lang-option" data-lang="en">English</button>
                </li>
                <li role="menuitem">
                    <button class="lang-option" data-lang="de">Deutsch</button>
                </li>
            </ul>
        `;
        
        nav.appendChild(dropdownContainer);
        
        // Toggle dropdown
        const toggleBtn = document.getElementById('lang-dropdown-toggle');
        const menu = document.getElementById('lang-dropdown-menu');
        
        toggleBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            
            // On mobile, only allow dropdown toggle when mobile menu is open
            const isMobile = window.innerWidth <= 768;
            if (isMobile && window.mobileMenu && !window.mobileMenu.isMenuOpen()) {
                return; // Don't toggle if mobile menu is closed
            }
            
            const isOpen = menu.classList.contains('show');
            menu.classList.toggle('show');
            toggleBtn.setAttribute('aria-expanded', !isOpen);
        });
        
        // Close dropdown when clicking outside
        document.addEventListener('click', (e) => {
            if (!dropdownContainer.contains(e.target)) {
                menu.classList.remove('show');
                toggleBtn.setAttribute('aria-expanded', 'false');
            }
        });
        
        // Language selection
        const langOptions = document.querySelectorAll('.lang-option');
        langOptions.forEach(option => {
            option.addEventListener('click', (e) => {
                const selectedLang = e.target.getAttribute('data-lang');
                this.switchLanguage(selectedLang);
                menu.classList.remove('show');
                toggleBtn.setAttribute('aria-expanded', 'false');
            });
            
            // Highlight current language
            if (option.getAttribute('data-lang') === this.currentLanguage) {
                option.classList.add('active');
            }
        });
    }
    
    updateToggleButton() {
        const currentSpan = document.querySelector('.lang-current');
        const languages = {
            en: '🇬🇧 English',
            de: '🇩🇪 Deutsch'
        };
        
        if (currentSpan) {
            currentSpan.textContent = languages[this.currentLanguage];
        }
        
        // Update active state in dropdown
        document.querySelectorAll('.lang-option').forEach(option => {
            if (option.getAttribute('data-lang') === this.currentLanguage) {
                option.classList.add('active');
            } else {
                option.classList.remove('active');
            }
        });
    }

    // javascript
    // Insert the following inside the LanguageSwitcher class in `translations.js`

    applyLocalizedVideo(retries = 10) {
        const iframe = document.querySelector('.hero-video-frame iframe');
        if (!iframe) {
            if (retries > 0) {
                setTimeout(() => this.applyLocalizedVideo(retries - 1), 100);
            }
            return;
        }

        const defaultId = 'CeMSDVuQ2yA';
        const videoId = translations[this.currentLanguage] && translations[this.currentLanguage]['video.id']
            ? translations[this.currentLanguage]['video.id']
            : defaultId;

        iframe.src = `https://www.youtube.com/embed/${videoId}`;

        const title = translations[this.currentLanguage] && translations[this.currentLanguage]['video.title']
            ? translations[this.currentLanguage]['video.title']
            : 'Timepot overview video';

        iframe.title = `${title} (${this.currentLanguage})`;
    }


}

// Initialize language switcher when DOM is ready
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', () => {
        window.i18n = new LanguageSwitcher();
    });
} else {
    window.i18n = new LanguageSwitcher();
}
