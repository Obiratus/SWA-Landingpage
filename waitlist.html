<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Join Waitlist - Timepot</title>
    <link rel="stylesheet" href="styles.css">
    <script defer src="https://cloud.umami.is/script.js" data-website-id="44aec67b-1dc1-4330-8456-c14c21477512"></script>
    <script src="translations.js"></script>
    <script src="mobile-menu.js"></script>
</head>
<body>
    <!-- Header -->
    <header>
        <nav class="navbar">
            <div class="container">
                <div class="logo">
                    <a href="index.html" class="logo-link" aria-label="Timepot home">
                        <img src="assets/Timepot_Logo-positive.svg" alt="Timepot logo" class="site-logo">
                    </a>
                </div>
                <button class="hamburger" id="hamburger-btn" aria-label="Toggle menu">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
                <ul class="nav-links" id="nav-menu">
                    <li><a href="index.html" data-i18n="nav.home">How it Works</a></li>
                    <li><a href="features.html" data-i18n="nav.features">Features</a></li>
                </ul>
            </div>
        </nav>
        <div class="menu-overlay" id="menu-overlay"></div>
    </header>

    <!-- Signup Section -->
    <section class="signup-section signup-page">
        <div class="container">
            <div class="signup-content">
                <h2 data-i18n="waitlist.title">Join the Waitlist</h2>
                <p class="waitlist-message" data-i18n="waitlist.message">Awesome that you're interested in Timepot. We're not quite ready yet; while we can't promise a price today, we promise to put a lot of love into building your family's screen-time tool.</p>
                
                <form id="waitlist-form" class="waitlist-form">
                    <div class="form-group">
                        <input 
                            type="email" 
                            id="waitlist-email" 
                            data-i18n-placeholder="waitlist.email-placeholder"
                            placeholder="Enter your email address"
                            required
                            class="email-input"
                        >
                    </div>
                    <button type="submit" class="cta-button waitlist-cta-button" id="waitlist-submit-btn" data-i18n="waitlist.cta">
                        Join Waitlist
                    </button>
                    <div id="waitlist-message" class="form-message"></div>
                </form>
                    <div id="post-signup" class="post-signup" style="display: none;">
                        <div id="thank-you-container"></div>
                        <div id="survey-prompt" class="survey-prompt">
                            <p data-i18n="waitlist.survey.prompt">Would you be open to a quick follow-up survey so we can build Timepot with your feedback?</p>
                            <div class="button-group survey-buttons">
                                <a
                                    id="survey-yes"
                                    class="cta-button survey-cta"
                                    href="https://forms.cloud.microsoft/Pages/ResponsePage.aspx?id=WS4mp1YbWk-kEm8HGB9I7lAS-AZkj5tIpbHjqdB2TphUOFpQMVM0RktEV0EwRUQzUzlVTDNGRUo2MC4u"
                                    target="_blank"
                                    rel="noopener"
                                    data-i18n="waitlist.survey.yes"
                                >Sure, show me the survey</a>
                                <button type="button" id="survey-no" class="cta-button cta-ghost" data-i18n="waitlist.survey.no">Maybe later</button>
                            </div>
                        </div>
                    </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container">
            <p data-i18n="footer.copyright">&copy; <span id="current-year"></span> Timepot. All rights reserved.</p>
            <div class="footer-links">
                <a href="waitlist.html" data-i18n="waitlist.cta">Join Waitlist</a>
            </div>
        </div>
    </footer>

    <script src="script.js"></script>
    <script src="tracking.js"></script>
    <script>
        // Set current year
        document.getElementById('current-year').textContent = new Date().getFullYear();
        
        // Handle waitlist form submission
        const waitlistForm = document.getElementById('waitlist-form');
        const emailInput = document.getElementById('waitlist-email');
        const submitBtn = document.getElementById('waitlist-submit-btn');
        const messageDiv = document.getElementById('waitlist-message');
        const surveyPrompt = document.getElementById('survey-prompt');
        const surveyYes = document.getElementById('survey-yes');
        const surveyNo = document.getElementById('survey-no');
    const postSignup = document.getElementById('post-signup');
    const thankYouContainer = document.getElementById('thank-you-container');
    const waitlistFormContainer = document.querySelector('.waitlist-form');
        
        waitlistForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const email = emailInput.value.trim();
            
            // Basic email validation
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!email || !emailRegex.test(email)) {
                messageDiv.textContent = window.i18n ? window.i18n.translate('waitlist.error') : 'Please enter a valid email address.';
                messageDiv.className = 'form-message error';
                messageDiv.style.display = 'block';
                return;
            }
            
            // Disable form during submission
            submitBtn.disabled = true;
            submitBtn.textContent = 'Joining...';
            
            try {
                // Here you would typically send the email to your backend
                // For now, we'll just simulate success and track the event
                console.log('Email submitted:', email);
                
                // Track the signup
                if (typeof trackEvent === 'function') {
                    trackEvent('waitlist-signup', { email: email });
                }
                
                // Show success message
                messageDiv.textContent = window.i18n ? window.i18n.translate('waitlist.success') : 'Thanks! We\'ll be in touch soon.';
                messageDiv.className = 'form-message success';
                messageDiv.style.display = 'block';
                
                // Clear form
                emailInput.value = '';
                
                if (waitlistFormContainer) {
                    waitlistFormContainer.classList.add('success-state');
                }

                if (postSignup) {
                    postSignup.style.display = 'block';
                }

                if (thankYouContainer && !thankYouContainer.querySelector('.thank-you-message-block')) {
                    thankYouContainer.innerHTML = `
                        <div class="thank-you-message-block">
                            <h3 data-i18n="waitlist.thankyou.heading">You're on the list! ðŸŽ‰</h3>
                            <p data-i18n="waitlist.thankyou.copy">Thank you for joining the Timepot waitlist. We'll keep you in the loop as we prepare the launch.</p>
                        </div>
                    `;
                    if (window.i18n && typeof window.i18n.applyTranslations === 'function') {
                        window.i18n.applyTranslations();
                    }
                }

                if (surveyPrompt) {
                    surveyPrompt.style.display = 'block';
                }
                
                // Re-enable button after a delay
                setTimeout(() => {
                    submitBtn.disabled = false;
                    submitBtn.textContent = window.i18n ? window.i18n.translate('waitlist.cta') : 'Join Waitlist';
                }, 2000);
                
            } catch (error) {
                console.error('Error submitting email:', error);
                messageDiv.textContent = 'Something went wrong. Please try again.';
                messageDiv.className = 'form-message error';
                messageDiv.style.display = 'block';
                
                submitBtn.disabled = false;
                submitBtn.textContent = window.i18n ? window.i18n.translate('waitlist.cta') : 'Join Waitlist';
            }
        });

        if (surveyYes) {
            surveyYes.addEventListener('click', () => {
                if (typeof trackEvent === 'function') {
                    trackEvent('waitlist-survey-opt-in');
                }
            });
        }

        if (surveyNo) {
            surveyNo.addEventListener('click', () => {
                if (surveyPrompt) {
                    surveyPrompt.style.display = 'none';
                }
                if (typeof trackEvent === 'function') {
                    trackEvent('waitlist-survey-decline');
                }
            });
        }

        // Track navigation clicks
        document.querySelectorAll('.nav-links a').forEach(link => {
            link.addEventListener('click', (e) => {
                const linkText = e.target.textContent.toLowerCase().replace(/\s+/g, '-');
                trackEvent(`nav-${linkText}-click`);
            });
        });

        // Track footer clicks
        document.querySelectorAll('.footer-links a').forEach(link => {
            link.addEventListener('click', (e) => {
                const linkText = e.target.textContent.toLowerCase().replace(/\s+/g, '-');
                trackEvent(`footer-${linkText}-click`);
            });
        });
    </script>
</body>
</html>
